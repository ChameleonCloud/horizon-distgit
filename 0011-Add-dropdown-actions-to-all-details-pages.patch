From 9ceb0268b2503e29056fba309fd750edf6d02936 Mon Sep 17 00:00:00 2001
From: Ana Krivokapic <akrivoka@redhat.com>
Date: Wed, 3 Sep 2014 12:09:02 +0200
Subject: [PATCH] Add dropdown actions to all details pages

Partially implements: blueprint detail-pages-ia

Change-Id: Ic09385d19b417b256cbc51d044d66ecbb54c7d52

Conflicts:
	openstack_dashboard/dashboards/admin/networks/views.py
---
 openstack_dashboard/dashboards/admin/networks/tests.py            | 7 +++++++
 openstack_dashboard/dashboards/project/images/images/views.py     | 3 ---
 openstack_dashboard/dashboards/project/instances/views.py         | 3 ---
 openstack_dashboard/dashboards/project/networks/views.py          | 3 ---
 openstack_dashboard/dashboards/project/stacks/views.py            | 7 ++++---
 openstack_dashboard/dashboards/project/volumes/backups/views.py   | 4 ----
 openstack_dashboard/dashboards/project/volumes/snapshots/views.py | 3 ---
 openstack_dashboard/dashboards/project/volumes/volumes/views.py   | 8 ++++----
 8 files changed, 15 insertions(+), 23 deletions(-)

diff --git a/openstack_dashboard/dashboards/admin/networks/tests.py b/openstack_dashboard/dashboards/admin/networks/tests.py
index e26ad31..de933e7 100644
--- a/openstack_dashboard/dashboards/admin/networks/tests.py
+++ b/openstack_dashboard/dashboards/admin/networks/tests.py
@@ -191,12 +191,19 @@ class NetworkTests(test.BaseAdminViewTests):
         api.neutron.is_extension_supported(IsA(http.HttpRequest),
                                            'mac-learning')\
             .AndReturn(mac_learning)
+<<<<<<< HEAD
         api.neutron.is_extension_supported(
             IsA(http.HttpRequest),
             'dhcp_agent_scheduler').AndReturn(True)
         api.neutron.is_extension_supported(
             IsA(http.HttpRequest),
             'dhcp_agent_scheduler').AndReturn(True)
+=======
+        api.neutron.is_extension_supported(IsA(http.HttpRequest),
+                'dhcp_agent_scheduler').AndReturn(True)
+        api.neutron.is_extension_supported(IsA(http.HttpRequest),
+                'dhcp_agent_scheduler').AndReturn(True)
+>>>>>>> dc6b1ce... Add dropdown actions to all details pages
 
         self.mox.ReplayAll()
 
diff --git a/openstack_dashboard/dashboards/project/images/images/views.py b/openstack_dashboard/dashboards/project/images/images/views.py
index 97475b0..58fd5ae 100644
--- a/openstack_dashboard/dashboards/project/images/images/views.py
+++ b/openstack_dashboard/dashboards/project/images/images/views.py
@@ -91,9 +91,6 @@ class DetailView(tabs.TabView):
         context["image"] = image
         context["url"] = self.get_redirect_url()
         context["actions"] = table.render_row_actions(image)
-        context["page_title"] = _("Image Details: "
-                                  "%(image_name)s") % {'image_name':
-                                                       image.name}
         return context
 
     @staticmethod
diff --git a/openstack_dashboard/dashboards/project/instances/views.py b/openstack_dashboard/dashboards/project/instances/views.py
index 178f9f0..3686ede 100644
--- a/openstack_dashboard/dashboards/project/instances/views.py
+++ b/openstack_dashboard/dashboards/project/instances/views.py
@@ -260,9 +260,6 @@ class DetailView(tabs.TabView):
         table = project_tables.InstancesTable(self.request)
         context["url"] = reverse(self.redirect_url)
         context["actions"] = table.render_row_actions(instance)
-        context["page_title"] = _("Instance Details: "
-                                  "%(instance_name)s") % {'instance_name':
-                                                          instance.name}
         return context
 
     @memoized.memoized_method
diff --git a/openstack_dashboard/dashboards/project/networks/views.py b/openstack_dashboard/dashboards/project/networks/views.py
index ec2e26a..c9610de 100644
--- a/openstack_dashboard/dashboards/project/networks/views.py
+++ b/openstack_dashboard/dashboards/project/networks/views.py
@@ -136,9 +136,6 @@ class DetailView(tables.MultiTableView):
         table = project_tables.NetworksTable(self.request)
         context["url"] = self.get_redirect_url()
         context["actions"] = table.render_row_actions(network)
-        context["page_title"] = _("Network Details: "
-                                  "%(network_name)s") % {'network_name':
-                                                         network.name}
         return context
 
     @staticmethod
diff --git a/openstack_dashboard/dashboards/project/stacks/views.py b/openstack_dashboard/dashboards/project/stacks/views.py
index 890cc39..b08b172 100644
--- a/openstack_dashboard/dashboards/project/stacks/views.py
+++ b/openstack_dashboard/dashboards/project/stacks/views.py
@@ -204,9 +204,6 @@ class DetailView(tabs.TabView):
         context["stack"] = stack
         context["url"] = self.get_redirect_url()
         context["actions"] = table.render_row_actions(stack)
-        context["page_title"] = _("Stack Details: "
-                                  "%(stack_name)s") % {'stack_name':
-                                                       stack.stack_name}
         return context
 
     @memoized.memoized_method
@@ -242,6 +239,10 @@ class DetailView(tabs.TabView):
     def get_redirect_url():
         return reverse('horizon:project:stacks:index')
 
+    @staticmethod
+    def get_redirect_url():
+        return reverse('horizon:project:stacks:index')
+
 
 class ResourceView(tabs.TabView):
     tab_group_class = project_tabs.ResourceDetailTabs
diff --git a/openstack_dashboard/dashboards/project/volumes/backups/views.py b/openstack_dashboard/dashboards/project/volumes/backups/views.py
index fbbad2c..43e1afd 100644
--- a/openstack_dashboard/dashboards/project/volumes/backups/views.py
+++ b/openstack_dashboard/dashboards/project/volumes/backups/views.py
@@ -53,10 +53,6 @@ class BackupDetailView(tabs.TabView):
         context["backup"] = backup
         context["url"] = self.get_redirect_url()
         context["actions"] = table.render_row_actions(backup)
-        context["page_title"] = _("Volume Backup Details: "
-                                  "%(backup_name)s") % {'backup_name':
-                                                        backup.name}
-
         return context
 
     @memoized.memoized_method
diff --git a/openstack_dashboard/dashboards/project/volumes/snapshots/views.py b/openstack_dashboard/dashboards/project/volumes/snapshots/views.py
index 8fa7e18..2e2227a 100644
--- a/openstack_dashboard/dashboards/project/volumes/snapshots/views.py
+++ b/openstack_dashboard/dashboards/project/volumes/snapshots/views.py
@@ -69,9 +69,6 @@ class DetailView(tabs.TabView):
         context["snapshot"] = snapshot
         context["url"] = self.get_redirect_url()
         context["actions"] = table.render_row_actions(snapshot)
-        context["page_title"] = _("Volume Snapshot Details: "
-                                  "%(snapshot_name)s") % {'snapshot_name':
-                                                          snapshot.name}
         return context
 
     @memoized.memoized_method
diff --git a/openstack_dashboard/dashboards/project/volumes/volumes/views.py b/openstack_dashboard/dashboards/project/volumes/volumes/views.py
index f32b0dc..32b96d3 100644
--- a/openstack_dashboard/dashboards/project/volumes/volumes/views.py
+++ b/openstack_dashboard/dashboards/project/volumes/volumes/views.py
@@ -45,12 +45,12 @@ class DetailView(tabs.TabView):
     template_name = 'project/volumes/volumes/detail.html'
 
     def get_context_data(self, **kwargs):
-        datum = self.get_data()
-        table = project_tables.VolumesTable(self.request)
         context = super(DetailView, self).get_context_data(**kwargs)
-        context["volume"] = datum
+        volume = self.get_data()
+        table = project_tables.VolumesTable(self.request)
+        context["volume"] = volume
         context["url"] = self.get_redirect_url()
-        context["actions"] = table.render_row_actions(datum)
+        context["actions"] = table.render_row_actions(volume)
         return context
 
     @memoized.memoized_method
